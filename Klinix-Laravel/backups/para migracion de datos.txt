--Migracion de doctores
INSERT INTO doctors
  ("LastName", "FirstName", "Address", "City_Id", "PhoneNumber", "CellPhoneNumber", "SupportWhatsapp", "Email","UrevUsuario","UrevFechaHora")
SELECT
  d.lastname,
  d.firstname,
  d.address,
  1 AS City_Id,
  d.phonenumber,
  d.cellphonenumber,
  d.supportwhatsapp,
  d.email,
  'Admin - Migracion',
  now()
FROM "doctor" d;


--Migracion de pacientes
INSERT INTO public.peoples
(
  "LastName",
  "FirstName",
  "Title",
  "DocumentNo",
  "Nationality",
  "Birthday",
  "Id_Sex",
  "Photo",
  "Address",
  "City",
  "City_Id",
  "PhoneNumber",
  "CellPhoneNumber",
  "SupportWhatsapp",
  "Email",
  "Notes",
  "BloodType",
  "RhFactor",
  "Allergies",
  "Id_Marital_Status",
  "MedicalInsurance",
  "DeathDate",
  "DeathCause",
  "DeathPlace",
  "DeathCertificateNumber",
  "MedicalDiagnosis",
  "District",
  "Neighborhood",
  "PatientCode",
  "Id_Department",
  "MRTDs",
  "PeopleNo",
  "Id_Type_People",


  "UrevUsuario",
  "UrevFechaHora"
)
SELECT
  p.lastname,
  p.firstname,
  p.title,
  p.documentno,
  p.nationality,
  p.birthday::timestamp(0),
  CASE 
    WHEN p.sex = 'F' THEN 1
    ELSE 2
  END AS "Id_Sex",
  p.photo,
  p.address,
  p.city,
  NULL::int8 AS "City_Id",          -- aqu√≠ pon el mapeo si lo tienes
  p.phonenumber,
  p.cellphonenumber,
  p.supportwhatsapp,
  p.email,
  p.notes,
  p.bloodtype,
  p.rhfactor,
  p.allergies,
  1,
  p.medicalinsurance,
  p.deathdate::timestamp(0),
  p.deathcause,
  p.deathplace,
  p.deathcertificatenumber,
  p.medicaldiagnosis,
  p.district,
  p.neighborhood,
  p.patientcode,
  1,
  NULL,
  NULL,
  2,
  'Admin - Migracion'::varchar(255) AS "UrevUsuario",
  now()::timestamp(0) AS "UrevFechaHora"
from "patient" p;


--migracion para consultorios 
INSERT INTO public.resources
("ResourceColor", 
"ResourceNumber", 
"ResourceName",
"ResourceVisible", 
"Id_Doctor",
"ResourceWorkStart", 
"ResourceWorkFinish", 
"UrevUsuario", 
"UrevFechaHora")
select  
ResourceColor, 
null, 
ResourceName,
1, 
1,
ResourceWorkStart, 
ResourceWorkFinish, 
'Admin - Migracion', 
now()
from resource r ;

